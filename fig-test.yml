# data only container pattern
datatest:
  image: muccg/base:debian8
  volumes:
    - .:/app
    - data/test:/data

dbtest:
  image: postgres:9.3
  environment:
    - POSTGRES_USER=bpamapp
    - POSTGRES_PASSWORD=bpamapp
  ports:
    - ":5432"

# runs the tests against the stack above
testhost:
  build: .
  command: runtests
  environment:
    - DJANGO_SETTINGS_MODULE=bpam.testsettings
    - DBUSER=bpamapp
    - WAIT_FOR_DB=1
  volumes_from:
    - datatest
  links:
    - dbtest:db
